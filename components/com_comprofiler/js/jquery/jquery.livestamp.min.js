(function(e){if(typeof define==="function"&&define.amd){define(["jquery","moment"],e)}else{e(jQuery,moment)}})(function(e,t){var n=1e3,a=false,i=e([]),f=function(){o.resume()},r=function(n,a){var f=n.data("livestampdata");if(typeof a=="number")a*=1e3;n.removeAttr("data-livestamp").removeData("livestamp");a=t(a);if(t.isMoment(a)&&!isNaN(+a)){var r=e.extend({},{original:n.contents()},f);r.moment=t(a);n.data("livestampdata",r).empty();i.push(n[0])}},u=function(){if(a)return;o.update();setTimeout(u,n)},o={update:function(){e("[data-livestamp]").each(function(){var t=e(this);r(t,t.data("livestamp"))});var n=[];i.each(function(){var a=e(this),i=a.data("livestampdata");if(i===undefined)n.push(this);else if(t.isMoment(i.moment)){var f=a.html(),r=i.moment.fromNow();if(f!=r){var u=e.Event("change.livestamp");a.trigger(u,[f,r]);if(!u.isDefaultPrevented())a.html(r)}}});i=i.not(n);delete i.prevObject},pause:function(){a=true},resume:function(){a=false;u()},interval:function(e){if(e===undefined)return n;n=e}},m={add:function(n,a){if(typeof a=="number")a*=1e3;a=t(a);if(t.isMoment(a)&&!isNaN(+a)){n.each(function(){r(e(this),a)});o.update()}return n},destroy:function(t){i=i.not(t);t.each(function(){var n=e(this),a=n.data("livestampdata");if(a===undefined)return t;n.html(a.original?a.original:"").removeData("livestampdata")});return t},isLivestamp:function(e){return e.data("livestampdata")!==undefined}};e.livestamp=o;e(f);e.fn.livestamp=function(e,t){if(!m[e]){t=e;e="add"}return m[e](this,t)}});