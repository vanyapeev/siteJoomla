(function(e){var t=[];var i={init:function(i){return this.each(function(){var n=this;var s=e(n).data("cbtimeago");if(s){return}s={};s.options=typeof i!="undefined"?i:{};s.defaults=e.fn.cbtimeago.defaults;s.settings=e.extend(true,{},s.defaults,s.options);s.element=e(n);s.datetime=s.element.data("cbtimeago-datetime");if(!s.datetime){s.datetime=s.element.attr("title");if(!s.datetime){s.datetime=s.element.text()}}if(s.settings.useData){e.each(s.defaults,function(e,t){if(e!="init"&&e!="useData"){var i=s.element.data("cbtimeago"+e.charAt(0).toUpperCase()+e.slice(1));if(typeof i!="undefined"){s.settings[e]=i}else{i=s.element.data("cbtimeago"+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase());if(typeof i!="undefined"){s.settings[e]=i}}}})}s.element.triggerHandler("cbtimeago.init.before",[s]);if(!s.settings.init){return}if(s.settings.hideAgo){s.settings.strings.future="%s";s.settings.strings.past="%s"}var a=null;if(typeof moment!="undefined"){a=moment.locale();moment.locale(Math.random(),{relativeTime:{future:s.settings.strings.future,past:s.settings.strings.past,s:s.settings.strings.seconds,m:s.settings.strings.minute,mm:s.settings.strings.minutes,h:s.settings.strings.hour,hh:s.settings.strings.hours,d:s.settings.strings.day,dd:s.settings.strings.days,M:s.settings.strings.month,MM:s.settings.strings.months,y:s.settings.strings.year,yy:s.settings.strings.years}})}s.livestamp=s.element.livestamp(s.datetime);if(a){moment.locale(a)}s.element.on("remove destroy.cbtimeago",function(){s.element.cbtimeago("destroy")});s.element.on("rebind.cbtimeago",function(){s.element.cbtimeago("rebind")});s.element.on("modified.cbtimeago",function(e,t,i,n){if(t!=i){s.element.cbtimeago("rebind")}});s.element.on("cloned.cbtimeago",function(){e(this).off("destroy.cbtimeago");e(this).off("rebind.cbtimeago");e(this).off("cloned.cbtimeago");e(this).off("modified.cbtimeago");e(this).removeData("cbtimeago");e(this).removeData("livestampdata");e(this).text("");if(!e(this).data("cbtimeago-datetime")&&!e(this).attr("title")){e(this).text(s.datetime)}e(this).cbtimeago(s.options)});s.element.triggerHandler("cbtimeago.init.after",[s]);s.element.data("cbtimeago",s);t.push(s)})},rebind:function(){var t=e(this).data("cbtimeago");if(!t){return this}t.element.cbtimeago("destroy");t.element.cbtimeago(t.options);return this},destroy:function(){var i=e(this).data("cbtimeago");if(!i){return this}i.element.livestamp("destroy");i.element.off("destroy.cbtimeago");i.element.off("rebind.cbtimeago");i.element.off("cloned.cbtimeago");i.element.off("modified.cbtimeago");e.each(t,function(e,n){if(n.element==i.element){t.splice(e,1);return false}return true});i.element.text("");if(!i.element.data("cbtimeago-datetime")&&!i.element.attr("title")){i.element.text(i.datetime)}i.element.removeData("cbtimeago");i.element.triggerHandler("cbtimeago.destroyed",[i]);return this},instances:function(){return t}};e.fn.cbtimeago=function(e){if(i[e]){return i[e].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof e==="object"||!e){return i.init.apply(this,arguments)}return this};e.fn.cbtimeago.defaults={init:true,useData:true,hideAgo:false,strings:{future:"in %s",past:"%s ago",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years"}}})(jQuery);