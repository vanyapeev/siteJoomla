(function(e){var t=[];var a={init:function(a){return this.each(function(){var i=this;var s=e(i).data("cbvalidate");if(s){return}s={};s.options=typeof a!="undefined"?a:{};s.defaults=e.fn.cbvalidate.defaults;s.settings=e.extend(true,{},s.defaults,s.options);s.element=e(i);if(s.settings.useData){e.each(s.defaults,function(e,t){if(e!="init"&&e!="useData"){var a=s.element.data("cbvalidate"+e.charAt(0).toUpperCase()+e.slice(1));if(typeof a!="undefined"){s.settings[e]=a}else{a=s.element.data("cbvalidate"+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase());if(typeof a!="undefined"){s.settings[e]=a}}}})}s.element.triggerHandler("cbvalidate.init.before",[s]);if(!s.settings.init){return}if(s.settings.messages){e.extend(e.validator.messages,s.settings.messages)}s.element.on("submit",function(t){var a=e(this).find('button[type="submit"][data-submit-text],input[type="submit"][data-submit-text]');a.each(function(){var t=e(this).data("submit-text");var a=null;e(this).prop("disabled",true);if(e(this).is("input")){a=e(this).val();e(this).val(t)}else{a=e(this).html();e(this).html(t)}e(this).data("button-text",a)});var i=e(this).validate();i.cbIsFormSubmitting=true;var r=i.form();i.cbIsFormSubmitting=false;if(!r){a.each(function(){var t=e(this).data("button-text");e(this).prop("disabled",false);if(e(this).is("input")){e(this).val(t)}else{e(this).html(t)}e(this).removeData("button-text")});var n=s.validate.errorList;if(n.length){var l=e(n[0].element);var o=l.closest(".cbTabPane");if(o.length){var d=o.closest(".cbTabs");if(d.length){var f=d.data("cbtabs");if(f){f.element.cbtabs("select",o.attr("id"))}}}e.scrollTo(l,0,{axis:"y",offset:{top:-((e(window).outerHeight()-l.outerHeight())/2),left:0}})}s.element.find(".cbValidationHasImageData").prop("disabled",false);i.focusInvalid();t.preventDefault()}else{s.element.find(".cbValidationHasImageData").prop("disabled",true)}s.element.triggerHandler("cbvalidate.validate",[s,r])});s.validate=s.element.validate({onsubmit:false,ignoreTitle:true,errorClass:"cbValidationMessage",validClass:"cbValidationMessage",ignore:'.cbValidationDisabled,.hidden,.disabled,.ignore,:disabled,[readonly],[type="hidden"]',cbIsFormSubmitting:false,cbIsOnFocusIn:false,cbIsOnFocusOut:false,cbIsOnKeyUp:false,cbIsOnClick:false,cbIsOnChange:false,success:function(t,a){var i=s.validate.errorsFor(a);if(i.length>1){i.not(t).remove()}var r=e(a).data("remote-response");if(!r){r=e(a).data("msg-success")}if(r){t.find(".cbValidationIcon").remove();t.removeClass("text-danger");t.html(r);if(r.toString().charAt(0)!="<"){t.prepend('<span class="cbValidationIcon fa fa-check"></span>');t.addClass("text-success")}}else{t.remove()}s.element.triggerHandler("cbvalidate.success",[s,t,a])},showErrors:function(t,a){var i=this;i.defaultShowErrors();e.each(a,function(t,a){if(e(a.element).hasClass("cbValidationHasImageData")){var s=e(a.element).siblings(".cbValidationImageData,.cbValidationImageDataCrop");if(s.length){s.remove()}e(a.element).removeClass("cbValidationHasImageData")}var r=i.errorsFor(a.element);if(r.length>1){r.not(":last").remove()}r.find(".cbValidationIcon").remove();r.removeClass("text-success");if(a.message.toString().charAt(0)!="<"){r.prepend('<span class="cbValidationIcon fa fa-times"></span>');r.addClass("text-danger")}});s.element.triggerHandler("cbvalidate.showerrors",[s,t,a])},highlight:function(t,a,i){e(t).addClass("cbValidationError");e(t).closest(".cb_form_line").addClass("cbValidationError has-error");e(t).closest("tr").addClass("cbValidationError has-error");var r=s.element.find(".cbTabs");if(r.length){r.each(function(){var t=e(this).data("cbtabs");if(t){e.each(t.tabs,function(e,t){var a=t.tabPane.find("input.cbValidationError,select.cbValidationError,textarea.cbValidationError").not(":submit,:reset,:image,[disabled],[readonly]").not(s.validate.settings.ignore);if(a.length){t.tabNav.addClass("cbValidationError has-error")}})}})}s.element.triggerHandler("cbvalidate.highlight",[s,t,a,i])},unhighlight:function(t,a,i){e(t).removeClass("cbValidationError");e(t).closest(".cb_form_line").removeClass("cbValidationError has-error");e(t).closest("tr").removeClass("cbValidationError has-error");var r=s.element.find(".cbTabs");if(r.length){r.each(function(){var t=e(this).data("cbtabs");if(t){e.each(t.tabs,function(e,t){var a=t.tabPane.find("input.cbValidationError,select.cbValidationError,textarea.cbValidationError").not(":submit,:reset,:image,[disabled],[readonly]").not(s.validate.settings.ignore);if(!a.length){t.tabNav.removeClass("cbValidationError has-error")}})}})}s.element.triggerHandler("cbvalidate.unhighlight",[s,t,a,i])},errorElement:"div",errorPlacement:function(e,t){var a=t.closest("td.fieldCell,.cbFieldSpan,.cb_field");if(a.length){e.appendTo(a)}else{e.insertAfter(t)}s.element.triggerHandler("cbvalidate.errorplacement",[s,e,t])},onfocusin:function(t){this.cbIsOnFocusIn=true;e.validator.defaults.onfocusin.call(this,t);this.cbIsOnFocusIn=false;s.element.triggerHandler("cbvalidate.focusin",[s,t])},onfocusout:function(t){this.cbIsOnFocusOut=true;e.validator.defaults.onfocusout.call(this,t);this.cbIsOnFocusOut=false;s.element.triggerHandler("cbvalidate.focusout",[s,t])},onkeyup:function(t,a){this.cbIsOnKeyUp=true;e.validator.defaults.onkeyup.call(this,t,a);this.cbIsOnKeyUp=false;s.element.triggerHandler("cbvalidate.keyup",[s,t,a])},onclick:function(t){this.cbIsOnClick=true;e.validator.defaults.onclick.call(this,t);this.cbIsOnClick=false;s.element.triggerHandler("cbvalidate.click",[s,t])},onchange:function(e){this.cbIsOnChange=true;if(e.name in this.submitted||!this.optional(e)){this.element(e)}this.cbIsOnChange=false;s.element.triggerHandler("cbvalidate.change",[s,e])}});s.element.on("change.validate","input,select,textarea",function(t){var a=e.data(this.form,"validator");var i="on"+t.type.replace(/^validate/,"");var s=a.settings;if(s[i]&&!e(this).is(s.ignore)){s[i].call(a,this,t)}});s.validate.options=s.settings;s.element.on("remove destroy.cbvalidate",function(){s.element.cbvalidate("destroy")});s.element.triggerHandler("cbvalidate.init.after",[s]);s.element.data("cbvalidate",s);t.push(s)})},validate:function(t,a){var i=e(this).data("cbvalidate");if(!i){return true}if(typeof t=="undefined"){t=null}if(typeof a=="undefined"){a=false}i.validate.cbIsFormSubmitting=true;var s=true;if(t){if(a){var r=i.validate.currentForm;i.validate.currentForm=t;var n=i.validate.elements();i.validate.currentForm=r;var l=0;n.each(function(){var t=this;e.each(r,function(e,a){if(a==t){if(!i.validate.element(a)){l++}}})});s=!l}else{s=i.validate.element(t)}}else{s=i.validate.form()}i.validate.cbIsFormSubmitting=false;if(!s){i.validate.focusInvalid()}i.element.triggerHandler("cbvalidate.validate",[i,s]);return s},reset:function(){var t=e(this).data("cbvalidate");if(!t){return false}t.validate.resetForm();t.element.triggerHandler("cbvalidate.reset",[t]);return true},invalid:function(){var t=e(this).data("cbvalidate");if(!t){return 0}var a=t.validate.numberOfInvalids();t.element.triggerHandler("cbvalidate.invalid",[t,a]);return a},focus:function(){var t=e(this).data("cbvalidate");if(!t){return false}t.validate.focusInvalid();t.element.triggerHandler("cbvalidate.focus",[t]);return true},valid:function(){var t=e(this).data("cbvalidate");if(!t){return true}var a=t.validate.valid();t.element.triggerHandler("cbvalidate.valid",[t,a]);return a},elements:function(t){var a=e(this).data("cbvalidate");if(!a){return[]}if(typeof t=="undefined"){t=null}var i=[];if(t=="invalid"){i=a.validate.invalidElements()}else if(t=="valid"){i=a.validate.validElements()}else{i=a.validate.elements()}a.element.triggerHandler("cbvalidate.elements",[a,i]);return i},errors:function(){var t=e(this).data("cbvalidate");if(!t){return[]}var a=t.validate.errors();t.element.triggerHandler("cbvalidate.errors",[t,a]);return a},destroy:function(){var t=e(this).data("cbvalidate");if(!t){return this}t.element.off("destroy.cbvalidate");t.validate.destroy();return this},instances:function(){return t}};e.validator.addMethod("creditcard",function(e,t){if(this.optional(t)){return"dependency-mismatch"}if(/[^0-9 \-]+/.test(e)){return false}var a=0,i=0,s=false,r,n;e=e.replace(/\D/g,"");if(e.length<13||e.length>19){return false}for(r=e.length-1;r>=0;r--){n=e.charAt(r);i=parseInt(n,10);if(s){if((i*=2)>9){i-=9}}a+=i;s=!s}return a%10===0},"Please enter a valid credit card number.");e.validator.addMethod("accept",function(t,a,i){var s=typeof i==="string"?i.replace(/\s/g,"").replace(/,/g,"|"):"image/*";var r=this.optional(a);if(r){return r}if(e(a).attr("type")==="file"){s=s.replace(/[\-\[\]\/\{\}\(\)\+\?\.\\\^\$\|]/g,"\\$&").replace(/,/g,"|").replace(/\/\*/g,"/.*");if(a.files&&a.files.length){for(var n=0;n<a.files.length;n++){var l=a.files[n];if(l.type&&!l.type.replace(/mp3/,"mpeg").replace(/m4a/,"mp4").match(new RegExp(".?("+s+")$","i"))){return false}}}}return true},e.validator.format("Please enter a value with a valid extension."));e.validator.addMethod("extension",function(e,t,a){a=typeof a==="string"?a.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(t)||e.match(new RegExp("\\.("+a+")$","i"))},e.validator.format("Please enter a value with a valid extension."));e.validator.addMethod("maxWords",function(t,a,i){return this.optional(a)||e(t).text().match(/\b\w+\b/g).length<=i},e.validator.format("Please enter {0} words or less."));e.validator.addMethod("minWords",function(t,a,i){return this.optional(a)||e(t).text().match(/\b\w+\b/g).length>=i},e.validator.format("Please enter at least {0} words."));e.validator.addMethod("rangeWords",function(t,a,i){var s=e(t).text();var r=/\b\w+\b/g;return this.optional(a)||s.match(r).length>=i[0]&&s.match(r).length<=i[1]},e.validator.format("Please enter between {0} and {1} words."));e.validator.addMethod("pattern",function(e,t,a){if(this.optional(t)){return true}if(typeof a==="string"){a=decodeURIComponent(a);var i=a.substr(0,1);var s=a.lastIndexOf(i);var r=a.slice(1,s);var n=a.substr(s+1);a=new RegExp(r,n)}return a.test(e)},"Invalid format.");e.validator.addMethod("isPattern",function(e,t,a){if(this.optional(t)){return true}try{if(typeof e==="string"){var i=e.substr(0,1);var s=e.lastIndexOf(i);var r=e.slice(1,s);var n=e.substr(s+1);e=new RegExp(r,n)}e.test("")}catch(e){return false}return true},"Invalid regular expression.");e.validator.addMethod("cburl",function(e,t){return this.optional(t)||/^(?:(https?|ftp):\/\/)?(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},"Please enter a valid URL.");e.validator.addMethod("cbusername",function(e,t){return this.optional(t)||!/^\s+|[<>"'%;()&\\]|\.\.\/|\s+$/i.test(e)},"Please enter a valid username with no space at beginning or end and must not contain the following characters: < > \\ \" ' % ; ( ) &");e.validator.addMethod("passwordstrength",function(t,a){if(!t){e(a).data("msg-success","");return true}var i=[/.{8,}/,/[A-Z]+/,/[a-z]+/,/\d+/,/[\-\]\\`~!@#$%^&*()_=+[{}|;:'",<.>\/?]+/,/.{12,}/,/[A-Z]{2,}/,/[a-z]{2,}/,/\d{2,}/,/[\-\]\\`~!@#$%^&*()_=+[{}|;:'",<.>\/?]{2,}/];var s=0;e.each(i,function(e,a){if(t.match(a)){s++}});if(s>i.length){s=i.length}else if(s<0){s=0}var r=s*(100/i.length);var n="cbPasswordStrengthStrong progress-bar-success";if(r<=30){n="cbPasswordStrengthVeryWeak progress-bar-danger"}else if(r<=50){n="cbPasswordStrengthWeak progress-bar-warning"}else if(r<=70){n="cbPasswordStrengthOk progress-bar-info"}var l=e(a).outerWidth();if(e(a).is(":hidden")){var o=e(a).clone(false).attr({id:"",class:""}).css({position:"absolute",display:"block",width:"auto",visibility:"hidden",padding:e(a).css("padding"),border:e(a).css("border"),margin:e(a).css("margin"),fontFamily:e(a).css("font-family"),fontSize:e(a).css("font-size"),fontWeight:e(a).css("font-weight"),boxSizing:e(a).css("box-sizing")}).appendTo("body");l=o.outerWidth();o.remove()}e(a).data("msg-success",'<div class="cbPasswordStrength progress" style="width: '+l+'px; margin: 0;"><div class="cbPasswordStrengthBar progress-bar '+n+'" style="width: '+r+'%"></div></div>');return true},"");e.validator.addMethod("filesize",function(t,a,s){var r=this.optional(a);if(r){return r}var n=false;var l=false;if((s[0]||s[1])&&e(a).attr("type")==="file"){if(a.files&&a.files.length){for(var o=0;o<a.files.length;o++){var d=a.files[o];var f=i(d.size,s[2]);if(s[0]&&f<s[0]){n=true}if(s[1]&&f>s[1]){l=true}}}}if(n||l){if(!this.settings.messages[a.name]){this.settings.messages[a.name]={};this.settings.messages[a.name].min=this.defaultMessage(a,"filesizemin");this.settings.messages[a.name].max=this.defaultMessage(a,"filesizemax");this.settings.messages[a.name].both=this.defaultMessage(a,"filesize")}if(n&&!l){this.settings.messages[a.name].filesize=this.settings.messages[a.name].min}else if(l&&!n){this.settings.messages[a.name].filesize=this.settings.messages[a.name].max}else{this.settings.messages[a.name].filesize=this.settings.messages[a.name].both}return false}return true},e.validator.format("File size must exceed the minimum of {0} {2}s, but not the maximum of {1} {2}s."));e.validator.addMethod("notEqualTo",function(t,a,i){return this.optional(a)||!e.validator.methods.equalTo.call(this,t,a,i)},"Please enter a different value, values must not be the same.");e.validator.addMethod("maxselect",function(t,a,i){return e.validator.methods.maxlength.call(this,t,a,i)},e.validator.format("Please select no more than {0} options."));e.validator.addMethod("minselect",function(t,a,i){return e.validator.methods.minlength.call(this,t,a,i)},e.validator.format("Please select at least {0} options."));e.validator.addMethod("requiredIf",function(t,a,i){var s=e(i);if(this.settings.onfocusout){s.off(".validate-requiredIf").on("blur.validate-requiredIf",function(){e(a).valid()})}if(s[0].nodeName.toLowerCase()==="select"){var r=s.val();if(!(r&&r.length>0)){return true}}var n=this.elementValue(s[0]);if(this.checkable(s[0])){if(this.getLength(n,s[0])<=0){return true}}if(n.length<=0){return true}return e.validator.methods.required.call(this,t,a,null)},"This field is required.");e.validator.addMethod("forbiddenWords",function(t,a,i){if(this.optional(a)){return true}if(e.isArray(i)){var s=true;e.each(i,function(e,a){if(a!==""&&t.indexOf(a)!=-1){s=false;return false}});return s}else{if(i!==""&&t.indexOf(i)!=-1){return false}}return true},"Invalid format.");e.validator.addMethod("cbfield",function(t,a,i){var s=this.options;if(!i.method){i.method="cbfield"}if(!i["function"]){i["function"]="checkvalue"}i.data={user:i.user,field:i.field,reason:i.reason,value:t};if(s.settings.cbfield.url){i.url=s.settings.cbfield.url}if(s.settings.cbfield.spooffield&&s.settings.cbfield.spooffield){i.data[s.settings.cbfield.spooffield]=s.settings.cbfield.spoofstring}if(s.settings.cbfield.spamfield&&s.settings.cbfield.spamstring){i.data[s.settings.cbfield.spamfield]=s.settings.cbfield.spamstring}return e.validator.methods.cbremote.call(this,t,a,i)},"Please fix this field.");e.validator.addMethod("cbremote",function(t,a,i){e(a).data("remote-response",null);if(this.optional(a)||this.cbIsOnChange||this.cbIsFormSubmitting||!i.url||e(a).hasClass("cbValidationRemoteSkip")){return true}e(a).addClass("cbValidationRemoteSkip");if(!e(a).valid()){e(a).removeClass("cbValidationRemoteSkip");return true}else{e(a).removeClass("cbValidationRemoteSkip")}e.each(i,function(e,t){if(typeof t!="object"&&typeof t!="array"&&e!="url"&&e!="data"){i.url=i.url.replace("["+e+"]",t)}});var s=this.previousValue(a);var r=this;if(!this.settings.messages[a.name]){this.settings.messages[a.name]={}}if(!i.method){i.method="cbremote"}s.originalMessage=this.settings.messages[a.name][i.method];this.settings.messages[a.name][i.method]=s.message;if(s.old===t){e(a).data("remote-response",e(s).data("remote-response"));return s.valid}else if(this.cbIsOnKeyUp){return true}s.old=t;e(s).data("remote-response",null);this.startRequest(a);e.ajax({url:i.url,type:"POST",mode:"abort",port:"validate"+a.name,dataType:"json",data:i.data,converters:{"text json":function(t){try{return e.parseJSON(t)}catch(e){return{valid:true,message:t}}}},beforeSend:function(){e('<span class="cbSpinner fa fa-spinner fa-spin-fast fa-infix"></span>').insertAfter(e(a))}}).done(function(n){var l=n.valid===true||n.valid==="true";var o={};var d=null;var f=null;r.settings.messages[a.name][i.method]=s.originalMessage;if(l){e(a).data("remote-response",n.message);e(s).data("remote-response",n.message);f=r.formSubmitted;r.resetInternals();r.toHide=r.errorsFor(a);r.prepareElement(a);r.formSubmitted=f;r.successList.push(a);delete r.invalid[a.name];r.showErrors()}else{d=n.message||r.defaultMessage(a,i.method);o[a.name]=s.message=e.isFunction(d)?d(t):d;r.invalid[a.name]=true;r.showErrors(o)}s.valid=l;r.stopRequest(a,l)}).always(function(){e(a).siblings(".cbSpinner").remove()});return"pending"},"Please fix this field.");e.validator.addMethod("resize",function(t,a,i){if(this.optional(a)||this.cbIsFormSubmitting||e(a).hasClass("cbValidationResizeSkip")){return true}var s=e(a).siblings(".cbValidationImageData,.cbValidationImageDataCrop");e(a).addClass("cbValidationResizeSkip");if(!e(a).valid()){e(a).removeClass("cbValidationResizeSkip");if(s.length){s.remove()}e(a).removeClass("cbValidationHasImageData");return true}else{e(a).removeClass("cbValidationResizeSkip")}if(!window.FileReader){if(s.length){s.remove()}e(a).removeClass("cbValidationHasImageData");return true}var r=this.previousValue(a);var n=this;if(r.old===t){return r.valid}r.old=t;if(s.length){s.remove()}e(a).removeClass("cbValidationHasImageData");var l=typeof i[0]!="undefined"?i[0]:0;var o=typeof i[1]!="undefined"?i[1]:0;var d=typeof i[2]!="undefined"?i[2]:1;var f=e.validator.messages.cropwidth;var u=e.validator.messages.cropheight;if((l||o)&&e(a).attr("type")==="file"){if(a.files&&a.files.length){for(var c=0;c<a.files.length;c++){var h=a.files[c];if(!h.type.match(/image/)){continue}var m=new FileReader;m.mimeType=h.type;this.startRequest(a);m.onload=function(t){var i=new Image;i.mimeType=this.mimeType;i.onload=function(t){var s=i.width;var c=i.height;var h=i.mimeType;var m=s;if(!l){l=m}var g=c;if(!o){o=g}var v=0;var b=0;if(!d){m=l;g=o}else if(d==1){if(m>l){g=g*(l/m);m=l}if(g>o){m=m*(o/g);g=o}}else if(d==2||d==3){if(l>o||o==l&&g>m){g=g*(l/m);m=l;if(d==2){b=o/2-g/2}}else if(o>l||o==l&&m>g){m=m*(o/g);g=o;if(d==2){v=l/2-m/2}}else if(m==g){m=l;g=o}}var p=null;if(g>m){p="portrait";if(g<=o){p="landscape"}}else if(m>g){p="landscape";if(m<=l){p="portrait"}}else{p="square"}if(s==m&&c==g&&d!=3){return}var F=document.createElement("canvas");if(d==2){F.width=l;F.height=o;if(p=="square"){v=0;b=0}}else{F.width=m;F.height=g}var I=F.getContext("2d");I.mozImageSmoothingEnabled=false;I.webkitImageSmoothingEnabled=false;I.msImageSmoothingEnabled=false;I.imageSmoothingEnabled=false;I.drawImage(i,v,b,m,g);var D=e(a).attr("name");e(a).addClass("cbValidationHasImageData");e('<input type="hidden"'+(D.length?' name="'+D+'_image_data"':"")+' value="'+F.toDataURL(h)+'" class="cbValidationImageData" />').insertAfter(e(a));if(d==3&&p!="square"){e('<div class="cbValidationImageDataCrop"><div class="cbValidationImageDataCropMsg">'+(p=="landscape"?f:p=="portrait"?u:"")+'</div><div class="cbValidationImageDataCropArea"><div class="cbValidationImageDataCropSelect"></div><img src="'+F.toDataURL(h)+'" class="cbValidationImageDataCropImage" /></div></div>').insertAfter(e(a).siblings(".cbValidationImageData"));var y=function(t){var a=0;var s=0;if(t===true){if(p=="landscape"){a=l/2-m/2}else if(p=="portrait"){s=o/2-g/2}}else{var r=e(this).position();if(p=="landscape"){if(e(this).parent().width()){a=-(m/(e(this).parent().width()/r.left))}}else if(p=="portrait"){if(e(this).parent().height()){s=-(g/(e(this).parent().height()/r.top))}}}var n=document.createElement("canvas");n.width=l;n.height=o;var d=n.getContext("2d");d.mozImageSmoothingEnabled=false;d.webkitImageSmoothingEnabled=false;d.msImageSmoothingEnabled=false;d.imageSmoothingEnabled=false;d.drawImage(i,a,s,m,g);if(t===true){e(this).siblings(".cbValidationImageData").val(n.toDataURL(h))}else{e(this).closest(".cbValidationImageDataCrop").siblings(".cbValidationImageData").val(n.toDataURL(h))}};y.call(a,true);e(a).siblings(".cbValidationImageDataCrop").find(".cbValidationImageDataCropImage").on("load",function(){e(this).siblings(".cbValidationImageDataCropSelect").draggable({containment:"parent",scroll:false,axes:p=="landscape"?"x":p=="portrait"?"y":false,create:function(){if(p=="landscape"){e(this).css({height:"100%",width:l/m*100+"%"}).css("left",e(this).parent().width()/2-e(this).width()/2+"px")}else if(p=="portrait"){e(this).css({height:o/g*100+"%",width:"100%"}).css("top",e(this).parent().height()/2-e(this).height()/2+"px")}else{e(this).css({height:"100%",width:"100%"})}y.call(this)},stop:function(e,t){y.call(this)}})})}r.valid=true;n.stopRequest(a,true)};i.src=t.target.result};m.readAsDataURL(h);return"pending"}}}return true});function i(e,t){if(t=="TB"){e=e/1024/1024/1024/1024}else if(t=="GB"){e=e/1024/1024/1024}else if(t=="MB"){e=e/1024/1024}else if(t=="KB"){e=e/1024}return e}e.fn.cbvalidate=function(e){if(a[e]){return a[e].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof e==="object"||!e){return a.init.apply(this,arguments)}return this};e.fn.cbvalidate.defaults={init:true,useData:false,messages:null,settings:null}})(jQuery);