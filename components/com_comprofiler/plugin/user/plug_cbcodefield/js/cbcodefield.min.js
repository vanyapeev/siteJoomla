!function(e){function t(t){var n=this.jquery?this:e(this);n.off("destroy.cbcodefield"),n.off("rebind.cbcodefield"),n.off("cloned.cbcodefield"),n.off("modified.cbcodefield"),n.removeData("cbcodefield"),t.timer&&clearTimeout(t.timer),e(t.settings.selectors).each(function(){i.call(this).off("keyup change",t.changeHandler)}),e.each(c,function(e,t){return t.element==n?(c.splice(e,1),!1):!0})}function i(){var t=this.jquery?this:e(this),i=null;return t.is("input")||t.is("select")||t.is("textarea")?i=t:(i=t.find("input,select,textarea").first(),(i.is(":checkbox")||i.is(":radio"))&&(i=t.find('input[name="'+i.attr("name")+'"]'))),i}function n(){var t=this.jquery?this:e(this),i=null;return(t.is("input")||t.is("select")||t.is("textarea"))&&(t.is('input[type="checkbox"]')||t.is('input[type="radio"]')?(i=[],t.each(function(){e(this).is(":checked")&&i.push(e(this).val())})):t.is("select[multiple]")?(i=t.val(),i&&!e.isArray(i)&&(i=i.split(","))):i=t.val()),i}var c=[],s={init:function(s){return this.each(function(){var a=this,r=e(a).data("cbcodefield");if(!r&&(r={},r.options=s,r.defaults=e.fn.cbcodefield.defaults,r.settings=e.extend(!0,{},r.defaults,r.options),r.element=e(a),r.settings.useData&&e.each(r.defaults,function(e){if("init"!=e&&"useData"!=e){var t=r.element.data("cbcodefield"+e.charAt(0).toUpperCase()+e.slice(1));"undefined"!=typeof t?r.settings[e]=t:(t=r.element.data("cbcodefield"+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),"undefined"!=typeof t&&(r.settings[e]=t))}}),(r.settings.selectors||e(r.settings.selectors).length)&&(r.element.triggerHandler("cbcodefield.init.before",[r]),r.settings.init))){(null===r.settings.post||"object"!=typeof r.settings.post&&!e.isArray(r.settings.post))&&(r.settings.post={}),r.target=i.call(r.element),r.timer=null;var d={};r.changeHandler=function(t){if("undefined"!=typeof t.data.codeUpdateTarget){var i=e(this).attr("name"),c=n.call(t.data.codeUpdateTarget);if(i.length){var s=r.target.attr("name"),a=n.call(r.target),l=r.settings.post;l[i]=c,s.length&&(l[s]=a);var o=400;"keyup"==t.type&&(o=800),r.timer&&clearTimeout(r.timer),r.timer=setTimeout(function(){if("undefined"!=typeof d[i]){var t=e.isArray(d[i])?d[i].toString():d[i],n=e.isArray(c)?c.toString():c;if(t===n)return}d[i]=c,e.ajax({url:r.settings.url,type:"POST",dataType:"html",cache:!1,data:l,beforeSend:function(e,t,i){r.element.find(".cbUpdateOptions").remove(),r.target.after('<span class="cbFieldIcons cbUpdateOptions"><span class="cbSpinner fa fa-spinner fa-spin-fast"></span></span>'),r.element.triggerHandler("cbcodefield.edit.send",[r,e,t,i])},error:function(e,t,i){r.element.find(".cbUpdateOptions").remove(),r.element.triggerHandler("cbcodefield.edit.error",[r,e,t,i])},success:function(t,i,n){r.element.find(".cbUpdateOptions").remove();var c=e("<div />").html(t);r.target.is("select")&&r.target.empty().append(c.find("select:first").children()),r.element.triggerHandler("cbcodefield.edit.success",[r,t,i,n])}})},o)}}},e(r.settings.selectors).each(function(){var e=i.call(this);e.on("keyup change",{codeUpdateTarget:e},r.changeHandler)}),r.element.on("remove destroy.cbcodefield",function(){r.element.cbcodefield("destroy")}),r.element.on("rebind.cbcodefield",function(){r.element.cbcodefield("rebind")}),r.element.on("modified.cbcodefield",function(e,t,i){t!=i&&r.element.cbcodefield("rebind")}),r.element.on("cloned.cbcodefield",function(){t.call(this,r),e(this).cbcodefield(r.options)}),r.element.triggerHandler("cbcodefield.init.after",[r]),r.element.data("cbcodefield",r),c.push(r)}})},rebind:function(){var t=e(this).data("cbcodefield");return t?(t.element.cbcodefield("destroy"),t.element.cbcodefield(t.options),this):this},destroy:function(){var i=e(this).data("cbcodefield");return i?(t.call(i.element,i),i.element.triggerHandler("cbcodefield.destroyed",[i]),!0):!1},instances:function(){return c}};e.fn.cbcodefield=function(e){return s[e]?s[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?this:s.init.apply(this,arguments)},e.cbcodefield=function(e){return"instances"==e?c:this},e.fn.cbcodefield.defaults={init:!0,useData:!1,selectors:null,url:null,post:null}}(jQuery);